library("xtable")
library("plyr")
library("edgeR")
library("qvalue")
#library("QuasiSeq")
library("maps")
library(clinfun)
library("fields")
library("fdrtool")
source('P:/qvalue_1.34.0/qvalue/R/qvalue_m0.R')
source("http://www.public.iastate.edu/~dnett/microarray/multtest.txt")
source("P:/QuasiSeq_Method_CompareFDR_BH_EBP_AHB_m0/hybrid-poisson-test-vc.R")
source("P:/QuasiSeq_Method_CompareFDR_BH_EBP_AHB_m0/Hyprid_poisson_test_vc_modified0.R")
source("P:/QuasiSeq_Method_CompareFDR_BH_EBP_AHB_m0/Hyprid_poisson_test_vc_modified1.R")
source("P:/QuasiSeq_Method_CompareFDR_BH_EBP_AHB_m0/fdrtool_1.2.10/fdrtool/R/ecdf.pval.R")
source("P:\\stevescode\\QuasiSeq_1.0-2\\QuasiSeq\\R\\QL.fit2.R")
source("P:\\stevescode\\QuasiSeq_1.0-2\\QuasiSeq\\R\\NBDev.R")
source("P:\\stevescode\\QuasiSeq_1.0-2\\QuasiSeq\\R\\PoisDev.R")
source("P:\\stevescode\\QuasiSeq_1.0-2\\QuasiSeq\\R\\QL.results.R")

# pbeta = 1
# "i =  5 ,j =  1 ,k =  1 ,l =  1 ,m =  37"
counts <- structure(c(1065, 5, 275, 809, 464, 375, 233, 13, 214, 0, 417, 
                      2005, 3, 0, 17, 174, 5, 876, 70, 8, 441, 191, 2, 177, 0, 284, 
                      366, 2367, 46, 362, 86, 127, 811, 3, 9, 48, 184, 473, 4, 0, 220, 
                      2, 3, 3, 307, 106, 7, 39, 12, 344, 79, 1299, 319, 91, 202, 410, 
                      75, 11, 1, 3, 23, 3, 33, 59, 541, 879, 37, 2, 31, 1141, 374, 
                      12, 155, 13, 225, 7, 25, 14, 1168, 853, 122, 1, 4, 109, 127, 
                      14, 6, 7, 32, 806, 0, 31, 206, 4, 145, 17, 0, 527, 3, 5160, 277, 
                      23, 252, 180, 98, 1464, 348, 7, 35, 29, 774, 2344, 18, 0, 115, 
                      893, 6, 496, 397, 5, 1241, 53, 0, 123, 3, 373, 462, 260, 79, 
                      421, 237, 292, 353, 0, 3, 25, 800, 203, 1, 4, 210, 4, 2, 0, 139, 
                      896, 10, 35, 20, 254, 316, 694, 451, 397, 154, 183, 8, 1, 2, 
                      2, 4, 5, 7, 31, 159, 2073, 15, 0, 3, 246, 146, 41, 103, 145, 
                      245, 9, 17, 20, 1571, 4385, 352, 0, 14, 91, 392, 19, 0, 6, 102, 
                      284, 2, 11, 72, 2, 192, 54, 3, 127, 0, 1515, 1224, 24, 341, 374, 
                      338, 318, 87, 1, 285, 2, 537, 896, 2, 1, 18, 349, 5, 299, 219, 
                      6, 232, 133, 2, 255, 3, 612, 364, 2311, 38, 1314, 93, 570, 744, 
                      29, 3, 14, 81, 458, 10, 0, 129, 4, 0, 2, 162, 183, 29, 107, 5, 
                      70, 47, 1459, 75, 26, 184, 380, 65, 1, 2, 8, 46, 8, 36, 81, 83, 
                      223, 45, 1, 13, 801, 305, 27, 82, 33, 49, 2, 59, 0, 224, 3942, 
                      189, 2, 11, 60, 44, 3, 0, 22, 13, 69, 0, 29, 73, 1, 501, 13, 
                      12, 200, 2, 3786, 1391, 29, 417, 49, 456, 236, 363, 23, 187, 
                      2, 245, 1071, 20, 0, 36, 237, 14, 961, 263, 19, 940, 152, 3, 
                      34, 5, 591, 718, 1879, 29, 94, 132, 272, 219, 4, 2, 9, 174, 1028, 
                      10, 7, 89, 2, 5, 1, 124, 280, 18, 80, 12, 441, 158, 693, 167, 
                      28, 191, 244, 25, 1, 0, 6, 10, 23, 5, 16, 178, 553, 11, 2, 29, 
                      205, 267, 26, 249, 52, 235, 3, 69, 9, 428, 1687, 277, 0, 26, 
                      124, 301, 22, 0, 16, 10, 72, 1, 29, 86, 10, 453, 89, 28, 214, 
                      0, 1427, 848, 4, 116, 290, 10, 547, 802, 22, 376, 26, 965, 1082, 
                      6, 0, 47, 1801, 19, 1337, 161, 8, 1217, 22, 7, 149, 23, 722, 
                      429, 849, 26, 239, 44, 412, 522, 2, 4, 12, 10, 97, 12, 4, 406, 
                      2, 0, 1, 319, 779, 11, 97, 3, 166, 34, 899, 135, 119, 43, 461, 
                      38, 1, 5, 0, 7, 1, 20, 10, 177, 886, 22, 6, 22, 656, 146, 29, 
                      303, 47, 158, 1, 26, 19, 391, 3899, 172, 1, 22, 79, 219, 35, 
                      0, 36, 77, 273, 4, 1, 253, 0, 555, 22, 1, 123, 2, 1252, 198, 
                      12, 102, 145, 71, 671, 2124, 21, 148, 2, 1165, 497, 33, 2, 103, 
                      207, 1, 1951, 340, 15, 565, 239, 5, 64, 3, 123, 413, 587, 71, 
                      187, 7, 789, 295, 3, 16, 55, 484, 241, 0, 3, 463, 8, 7, 1, 278, 
                      295, 46, 33, 10, 254, 191, 4169, 291, 235, 266, 1377, 8, 0, 1, 
                      5, 4, 5, 26, 96, 89, 295, 7, 1, 17, 516, 572, 36, 496, 41, 60, 
                      17, 35, 14, 1159, 2138, 725, 15, 13, 237, 153, 8, 1, 22, 151, 
                      69, 0, 5, 559, 12, 651, 194, 26, 219, 5, 2785, 303, 5, 140, 215, 
                      855, 256, 1679, 20, 121, 6, 434, 1015, 2, 0, 46, 298, 7, 553, 
                      245, 32, 364, 80, 2, 38, 5, 216, 637, 926, 5, 320, 114, 571, 
                      1230, 2, 1, 23, 79, 726, 4, 15, 669, 0, 7, 12, 254, 152, 9, 91, 
                      16, 141, 119, 258, 320, 144, 18, 868, 71, 6, 5, 0, 17, 5, 16, 
                      131, 227, 1094, 7, 3, 8, 400, 156, 16, 114, 31, 44, 6, 26, 10, 
                      638, 2205, 221, 8, 3, 269, 63, 2, 0, 5, 6, 148, 0, 14, 474, 3, 
                      141, 51, 2, 446, 0, 1384, 1065, 64, 329, 971, 951, 498, 201, 
                      23, 151, 11, 407, 389, 6, 1, 51, 388, 17, 369, 142, 17, 550, 
                      150, 7, 129, 4, 1183, 574, 1551, 13, 680, 190, 174, 753, 7, 3, 
                      41, 60, 276, 5, 0, 380, 0, 3, 11, 512, 453, 1, 42, 15, 679, 106, 
                      1140, 145, 80, 312, 460, 18, 3, 3, 5, 10, 24, 23, 94, 316, 64, 
                      61, 5, 7, 1174, 375, 7, 424, 20, 75, 1, 66, 10, 821, 1790, 64, 
                      1, 19, 64, 128, 26, 3, 3, 43, 226, 4, 1, 615, 10, 484, 111, 4, 
                      720, 0, 2266, 942, 12, 135, 67, 549, 423, 606, 59, 52, 1, 1028, 
                      2325, 37, 0, 72, 143, 15, 583, 46, 1, 727, 79, 4, 66, 3, 87, 
                      695, 2009, 28, 826, 34, 337, 527, 4, 2, 56, 101, 425, 12, 1, 
                      469, 0, 1, 3, 442, 82, 3, 28, 26, 548, 265, 901, 318, 112, 395, 
                      853, 114, 1, 8, 2, 2, 6, 11, 92, 410, 413, 17, 2, 13, 1213, 612, 
                      23, 566, 48, 46, 7, 45, 22, 522, 916, 179, 1, 1, 127, 124, 12, 
                      0, 35, 17, 145, 0, 58, 436, 2, 1438, 252, 6, 754, 0, 1647, 100, 
                      98, 116, 134, 524, 385, 1143, 13, 88, 2, 765, 157, 28, 0, 182, 
                      903, 7, 1587, 308, 98, 486, 449, 0, 55, 1, 437, 107, 1020, 127, 
                      373, 969, 199, 480, 1, 0, 54, 320, 536, 0, 6, 666, 3, 8, 0, 104, 
                      435, 16, 10, 18, 97, 188, 1601, 99, 185, 40, 421, 8, 1, 0, 3, 
                      18, 7, 17, 20, 59, 783, 19, 9, 13, 188, 16, 53, 187, 96, 42, 
                      2, 86, 38, 1210, 4823, 202, 3, 14, 26, 266, 4, 1, 6, 153, 434, 
                      0, 4, 122, 22, 481, 26, 15, 319, 5, 1889, 332, 1, 202, 488, 627, 
                      462, 1006, 36, 68, 1, 641, 311, 6, 0, 48, 178, 0, 1545, 66, 12, 
                      838, 362, 4, 38, 16, 277, 224, 432, 37, 558, 104, 243, 388, 7, 
                      7, 10, 63, 360, 2, 3, 447, 5, 4, 3, 608, 299, 10, 122, 33, 258, 
                      55, 1930, 31, 119, 160, 621, 128, 4, 6, 3, 50, 17, 37, 55, 335, 
                      92, 20, 1, 4, 756, 795, 31, 539, 19, 65, 0, 82, 6, 855, 4091, 
                      128, 3, 23, 67, 163, 3, 0, 12, 14, 160, 4, 36, 140, 2, 658, 58, 
                      14, 970, 10, 807, 421, 38, 380, 172, 611, 787, 181, 41, 172, 
                      30, 360, 3047, 11, 0, 34, 1115, 4, 5054, 416, 28, 270, 195, 1, 
                      37, 3, 612, 171, 2352, 9, 547, 73, 312, 612, 0, 9, 92, 120, 614, 
                      1, 3, 528, 0, 0, 0, 587, 313, 40, 177, 33, 618, 344, 275, 50, 
                      181, 133, 624, 64, 7, 2, 0, 11, 12, 13, 112, 336, 784, 32, 3, 
                      56, 889, 407, 56, 89, 254, 101, 14, 100, 54, 615, 3248, 33, 0, 
                      18, 209, 149, 18, 0, 25, 8, 451, 2, 16, 503, 7, 92, 85, 7, 95, 
                      3, 2296, 24, 27, 614, 563, 1433, 254, 114, 37, 532, 5, 62, 2716, 
                      18, 1, 21, 420, 7, 281, 40, 10, 116, 182, 3, 64, 2, 643, 966, 
                      2167, 11, 113, 40, 314, 477, 2, 7, 21, 173, 42, 6, 0, 275, 15, 
                      0, 5, 386, 130, 9, 148, 7, 251, 44, 760, 122, 74, 108, 300, 61, 
                      16, 1, 3, 44, 7, 39, 63, 652, 376, 6, 12, 17, 751, 597, 48, 410, 
                      15, 87, 1, 41, 4, 361, 2211, 88, 1, 2, 80, 107, 15, 0, 118, 18, 
                      453, 0, 11, 294, 2, 306, 86, 19, 316, 12, 3019, 461, 78, 198, 
                      137, 942, 2066, 661, 19, 307, 12, 970, 1856, 17, 0, 72, 150, 
                      11, 1446, 196, 9, 399, 65, 9, 149, 5, 229, 768, 6202, 30, 910, 
                      174, 401, 353, 9, 9, 37, 343, 989, 1, 7, 201, 2, 4, 0, 836, 328, 
                      5, 53, 16, 191, 126, 947, 189, 80, 114, 238, 101, 7, 0, 11, 29, 
                      2, 6, 129, 199, 2319, 14, 6, 12, 449, 319, 41, 297, 24, 263, 
                      4, 73, 10, 1276, 6704, 100, 5, 14, 52, 63, 11, 2, 4, 57, 289, 
                      1, 5, 97, 18, 907, 209, 6, 230, 2, 2140, 404, 42, 184, 86, 254, 
                      1559, 312, 23, 233, 14, 360, 4582, 25, 0, 84, 349, 10, 1266, 
                      146, 67, 348, 296, 2, 14, 1, 131, 249, 2253, 93, 89, 167, 31, 
                      257, 4, 3, 63, 986, 1845, 10, 0, 286, 9, 1, 5, 434, 205, 9, 94, 
                      14, 205, 115, 3074, 181, 419, 118, 1441, 14, 0, 0, 6, 53, 35, 
                      12, 48, 88, 2038, 8, 0, 57, 1051, 50, 32, 215, 57, 361, 1, 131, 
                      36, 2108, 4695, 689, 0, 6, 128, 114, 64, 4, 5, 33, 233, 0, 39, 
                      170, 12, 638, 26, 6, 90, 3, 1518, 1425, 7, 157, 116, 604, 468, 
                      770, 17, 248, 7, 674, 1401, 46, 0, 38, 295, 9, 816, 151, 8, 1393, 
                      165, 8, 34, 15, 1228, 856, 1177, 33, 294, 120, 151, 193, 22, 
                      11, 30, 41, 405, 6, 5, 187, 5, 0, 1, 78, 254, 25, 66, 17, 729, 
                      135, 728, 183, 69, 161, 80, 63, 1, 3, 5, 12, 0, 12, 146, 345, 
                      846, 8, 1, 18, 427, 774, 34, 158, 29, 251, 0, 25, 13, 917, 2845, 
                      475, 4, 8, 143, 137, 15, 0, 47, 5, 886, 5, 16, 234, 1, 603, 106, 
                      2, 121, 9, 2213, 676, 16, 529, 242, 592, 1730, 49, 4, 132, 0, 
                      138, 1861, 11, 0, 18, 208, 20, 1145, 45, 13, 488, 343, 1, 95, 
                      6, 1024, 955, 1693, 31, 351, 113, 489, 957, 7, 7, 4, 50, 858, 
                      9, 1, 282, 1, 2, 9, 209, 452, 48, 97, 10, 383, 83, 1804, 95, 
                      176, 167, 329, 118, 11, 2, 19, 9, 6, 1, 99, 69, 434, 5, 2, 23, 
                      1172, 471, 60, 245, 48, 89, 10, 34, 5, 373, 3908, 486, 3, 5, 
                      50, 17, 2, 1, 2, 62, 56, 0, 15, 200, 4, 424, 26, 23, 182, 4, 
                      2716, 1221, 6, 188, 599, 129, 277, 187, 6, 78, 0, 494, 2361, 
                      6, 0, 65, 145, 2, 697, 412, 1, 215, 199, 1, 29, 0, 409, 107, 
                      364, 11, 1004, 175, 368, 1150, 3, 0, 46, 60, 446, 7, 0, 141, 
                      0, 0, 5, 48, 660, 22, 110, 5, 133, 105, 4241, 167, 87, 31, 208, 
                      79, 6, 0, 14, 3, 1, 21, 103, 127, 527, 61, 3, 12, 762, 550, 21, 
                      63, 30, 41, 5, 20, 5, 606, 966, 179, 4, 11, 111, 63, 2, 0, 4, 
                      51, 153, 2, 8, 126, 5, 572, 229, 20, 89, 0, 1685, 1014, 42, 178, 
                      103, 469, 3258, 1162, 57, 124, 3, 167, 220, 30, 0, 44, 1070, 
                      16, 2664, 454, 50, 1301, 315, 2, 72, 2, 760, 169, 2603, 56, 592, 
                      290, 1526, 176, 13, 12, 8, 274, 690, 1, 2, 852, 1, 1, 1, 502, 
                      783, 7, 58, 25, 944, 78, 3525, 532, 145, 139, 1012, 10, 5, 0, 
                      0, 6, 3, 97, 42, 672, 994, 16, 5, 61, 282, 69, 81, 237, 151, 
                      57, 4, 11, 14, 2651, 6179, 213, 2, 19, 77, 606, 3, 5, 22, 27, 
                      579, 4, 26, 569, 8, 66, 59, 2, 290, 1, 1934, 352, 13, 306, 69, 
                      865, 611, 512, 7, 196, 7, 248, 3194, 5, 1, 31, 1264, 19, 623, 
                      85, 13, 875, 543, 6, 16, 22, 1909, 424, 1303, 79, 215, 342, 223, 
                      299, 3, 5, 19, 116, 569, 1, 2, 176, 0, 2, 4, 118, 302, 41, 52, 
                      10, 141, 130, 534, 349, 60, 72, 787, 62, 8, 0, 0, 52, 0, 34, 
                      251, 358, 1468, 24, 10, 28, 188, 426, 3, 138, 47, 91, 7, 20, 
                      42, 651, 5388, 326, 6, 19, 370, 208, 19, 0, 10, 39, 253, 0, 27, 
                      288, 10, 186, 166, 36, 212, 2, 4485, 96, 11, 393, 119, 22, 395, 
                      23, 31, 479, 0, 1086, 2781, 166, 3, 115, 1516, 30, 149, 218, 
                      3, 353, 292, 8, 36, 0, 215, 279, 1143, 32, 140, 187, 554, 97, 
                      3, 6, 15, 614, 1010, 2, 2, 365, 9, 0, 0, 624, 75, 25, 108, 32, 
                      390, 193, 348, 244, 122, 216, 405, 29, 0, 0, 0, 29, 7, 29, 25, 
                      31, 1286, 18, 9, 9, 597, 496, 45, 341, 74, 97, 7, 118, 27, 243, 
                      3673, 256, 0, 11, 270, 155, 2, 3, 40, 27, 356, 0, 28, 311, 8, 
                      195, 193, 6, 316, 4, 842, 339, 3, 404, 95, 66, 1355, 19, 43, 
                      415, 2, 2276, 2196, 106, 0, 110, 245, 8, 79, 282, 4, 431, 212, 
                      1, 76, 3, 283, 948, 3204, 4, 1387, 133, 437, 1142, 0, 0, 18, 
                      29, 335, 9, 14, 326, 4, 0, 2, 773, 276, 4, 167, 6, 656, 72, 4285, 
                      122, 61, 38, 391, 133, 18, 6, 0, 8, 66, 62, 129, 435, 699, 8, 
                      7, 5, 602, 254, 37, 885, 29, 34, 4, 35, 12, 798, 4821, 263, 1, 
                      10, 66, 307, 35, 1, 20, 8, 677, 0, 70, 814, 12, 422, 90, 23, 
                      304, 7, 5709, 1200, 18, 12, 211, 18, 184, 34, 2, 331, 2, 1655, 
                      14297, 54, 8, 50, 768, 6, 273, 140, 4, 583, 279, 2, 124, 3, 899, 
                      563, 4333, 21, 1087, 230, 567, 428, 6, 2, 4, 485, 186, 12, 6, 
                      258, 18, 0, 0, 1011, 301, 28, 126, 15, 329, 167, 3780, 556, 282, 
                      456, 1537, 5, 5, 0, 13, 91, 27, 50, 103, 441, 1179, 78, 8, 16, 
                      453, 215, 77, 552, 26, 98, 0, 89, 7, 424, 13056, 934, 0, 12, 
                      79, 67, 18, 2, 6, 21, 215, 0, 66, 603, 0, 960, 134, 11, 343, 
                      0, 908, 164, 28, 340, 156, 41, 595, 30, 12, 205, 3, 1194, 1392, 
                      31, 10, 131, 931, 3, 162, 151, 14, 308, 130, 1, 30, 9, 294, 379, 
                      983, 28, 68, 236, 286, 416, 0, 0, 53, 615, 1638, 14, 1, 511, 
                      1, 0, 2, 156, 265, 5, 40, 11, 352, 48, 1315, 1207, 422, 62, 785, 
                      6, 0, 2, 8, 23, 2, 14, 45, 460, 1896, 25, 1, 58, 223, 70, 25, 
                      415, 60, 224, 9, 86, 19, 2694, 3504, 71, 3, 27, 407, 87, 6, 0, 
                      1, 123, 116, 1, 1, 152, 2, 291, 97, 19, 28, 0, 1105, 501, 30, 
                      564, 220, 29, 1057, 19, 19, 48, 0, 1949, 3826, 204, 25, 23, 579, 
                      35, 529, 145, 9, 619, 319, 0, 52, 8, 402, 314, 3381, 15, 257, 
                      150, 1088, 403, 17, 9, 8, 210, 746, 30, 3, 416, 11, 1, 0, 209, 
                      582, 18, 49, 17, 283, 136, 1630, 307, 164, 61, 504, 41, 4, 0, 
                      0, 23, 0, 20, 91, 326, 950, 6, 3, 7, 867, 312, 27, 164, 155, 
                      270, 23, 68, 38, 731, 4519, 244, 0, 9, 398, 160, 20, 1, 5, 37, 
                      477, 11, 23, 768, 6, 1142, 45, 31, 166, 2, 1474, 220, 135, 256, 
                      103, 2, 244, 62, 70, 165, 4, 920, 854, 172, 11, 62, 289, 51, 
                      447, 573, 27, 679, 106, 1, 38, 13, 132, 921, 1119, 147, 409, 
                      416, 218, 507, 0, 0, 42, 1180, 953, 7, 4, 951, 0, 7, 1, 260, 
                      573, 7, 96, 52, 683, 170, 1142, 731, 259, 75, 1186, 24, 0, 4, 
                      10, 36, 5, 18, 41, 35, 1320, 20, 2, 41, 320, 184, 25, 472, 214, 
                      213, 10, 31, 25, 688, 4025, 284, 6, 7, 90, 101, 14, 3, 5, 278, 
                      142, 12, 1, 262, 30, 81, 93, 22, 191, 1, 1249, 58, 5, 470, 202, 
                      3, 5300, 24, 9, 607, 5, 1048, 2353, 53, 27, 82, 605, 58, 56, 
                      363, 1, 639, 242, 0, 85, 5, 348, 253, 444, 15, 307, 58, 102, 
                      264, 1, 5, 21, 582, 1462, 4, 3, 238, 0, 4, 2, 300, 206, 37, 6, 
                      5, 34, 113, 1897, 433, 54, 25, 836, 73, 1, 0, 0, 29, 3, 9, 138, 
                      146, 1363, 5, 3, 20, 332, 229, 22, 343, 23, 227, 2, 75, 15, 1158, 
                      4577, 280, 2, 9, 187, 241, 41, 0, 16, 107, 455, 2, 39, 176, 9, 
                      480, 59, 1, 13, 2, 717, 326, 7, 528, 160, 52, 974, 24, 25, 180, 
                      0, 446, 2896, 50, 0, 21, 506, 12, 178, 239, 1, 317, 262, 4, 298, 
                      1, 669, 205, 2108, 14, 427, 189, 773, 626, 21, 0, 14, 47, 434, 
                      4, 0, 366, 8, 0, 6, 312, 475, 33, 85, 12, 215, 54, 2854, 173, 
                      38, 352, 400, 58, 3, 12, 8, 5, 9, 77, 160, 786, 373, 84, 5, 10, 
                      2141, 200, 8, 136, 33, 31, 12, 20, 42, 449, 316, 479, 0, 9, 97, 
                      116, 0, 3, 35, 6, 88, 2, 136, 498, 16, 845, 171, 17, 1412, 4, 
                      1856, 2141, 11, 847, 356, 110, 758, 28, 45, 127, 2, 1349, 2175, 
                      128, 2, 55, 153, 9, 362, 59, 2, 267, 126, 0, 103, 1, 647, 543, 
                      2727, 13, 391, 44, 166, 974, 10, 3, 19, 327, 275, 5, 1, 587, 
                      0, 3, 8, 405, 170, 72, 39, 31, 93, 104, 1601, 69, 19, 215, 420, 
                      21, 0, 3, 11, 14, 12, 86, 35, 1161, 735, 2, 0, 12, 402, 369, 
                      4, 144, 8, 29, 9, 26, 2, 602, 1234, 162, 0, 7, 99, 141, 11, 1, 
                      77, 4, 1252, 0, 74, 647, 4, 547, 270, 6, 330, 12, 1887, 477, 
                      33, 44, 210, 12, 1718, 43, 36, 562, 0, 2026, 2221, 95, 5, 25, 
                      406, 17, 84, 425, 9, 334, 164, 1, 74, 0, 240, 617, 2173, 48, 
                      855, 102, 541, 504, 1, 2, 27, 146, 914, 11, 0, 376, 0, 2, 22, 
                      820, 752, 9, 6, 62, 321, 173, 650, 181, 51, 34, 545, 22, 6, 0, 
                      3, 17, 6, 15, 39, 146, 341, 38, 10, 11, 493, 818, 41, 328, 116, 
                      18, 7, 52, 8, 1135, 4100, 134, 4, 7, 193, 160, 4, 0, 16, 70, 
                      926, 0, 30, 97, 10, 1539, 82, 14, 439, 1, 3733, 1157, 32, 879, 
                      190, 23, 1916, 9, 37, 297, 1, 1311, 4184, 109, 0, 37, 326, 25, 
                      222, 141, 2, 366, 137, 1, 86, 4, 1197, 854, 1226, 28, 253, 56, 
                      559, 271, 13, 5, 61, 418, 1167, 6, 20, 61, 9, 0, 1, 636, 1234, 
                      14, 95, 22, 357, 84, 506, 185, 155, 278, 598, 41, 0, 4, 4, 62, 
                      9, 31, 117, 326, 1571, 22, 10, 15, 765, 463, 28, 89, 31, 72, 
                      15, 19, 11, 1183, 2489, 240, 2, 16, 327, 207, 9, 1, 13, 9, 722, 
                      0, 2, 314, 10, 351, 31, 2, 56, 0, 1684, 1335, 2, 302, 101, 30, 
                      785, 18, 23, 494, 1, 633, 1528, 32, 2, 12, 189, 7, 102, 191, 
                      4, 78, 234, 0, 120, 3, 547, 799, 747, 6, 279, 33, 341, 653, 5, 
                      3, 12, 154, 337, 5, 0, 248, 6, 2, 6, 383, 266, 25, 164, 5, 514, 
                      53, 2038, 120, 47, 262, 217, 206, 0, 6, 10, 13, 13, 5, 76, 147, 
                      258, 6, 6, 7, 650, 274, 12, 76, 21, 18, 8, 17, 8, 94, 4813, 91, 
                      0, 1, 75, 91, 5, 5, 7, 21, 181, 1, 36, 59, 6, 880, 36, 6, 237, 
                      2, 6109, 40, 45, 302, 66, 10, 1997, 24, 1, 157, 0, 482, 921, 
                      35, 1, 98, 567, 9, 1141, 151, 15, 634, 88, 1, 33, 12, 129, 800, 
                      441, 9, 501, 7, 317, 198, 6, 4, 25, 289, 1285, 1, 12, 147, 1, 
                      1, 1, 266, 253, 3, 44, 12, 135, 199, 1654, 167, 196, 70, 488, 
                      40, 1, 0, 0, 20, 2, 9, 24, 226, 1023, 5, 7, 76, 739, 382, 43, 
                      135, 55, 158, 0, 32, 23, 975, 3185, 283, 7, 22, 142, 278, 2, 
                      0, 13, 13, 334, 0, 6, 109, 1, 334, 126, 1, 228, 4, 1226, 776, 
                      13, 672, 261, 80, 1055, 18, 5, 683, 2, 512, 1579, 104, 2, 2, 
                      159, 2, 142, 175, 5, 249, 112, 6, 40, 9, 541, 131, 1799, 16, 
                      1133, 56, 506, 1010, 3, 11, 88, 114, 656, 9, 3, 359, 0, 1, 7, 
                      610, 41, 1, 139, 18, 188, 137, 1956, 234, 20, 257, 185, 23, 8, 
                      1, 1, 27, 9, 54, 128, 633, 904, 9, 3, 21, 477, 116, 55, 100, 
                      30, 101, 7, 15, 40, 933, 271, 106, 0, 11, 121, 96, 2, 1, 8, 5, 
                      112, 0, 40, 439, 8, 281, 80, 10, 861, 4, 5601, 344, 10, 214, 
                      419, 41, 1320, 37, 18, 204, 0, 342, 3730, 290, 28, 149, 551, 
                      10, 315, 99, 0, 730, 49, 0, 53, 0, 262, 245, 1069, 130, 212, 
                      193, 212, 104, 8, 12, 34, 337, 1146, 4, 0, 961, 0, 5, 6, 311, 
                      588, 15, 51, 1, 96, 63, 1396, 256, 350, 81, 772, 53, 2, 3, 1, 
                      18, 9, 3, 8, 152, 746, 10, 4, 17, 498, 256, 40, 341, 21, 286, 
                      10, 52, 15, 937, 5603, 485, 1, 14, 144, 424, 0, 0, 3, 94, 82, 
                      3, 5, 246, 12, 578, 117, 8, 97, 1, 1111, 459, 36, 148, 139, 4, 
                      2819, 56, 25, 118, 0, 423, 2072, 236, 10, 72, 593, 12, 246, 1011, 
                      42, 375, 149, 0, 7, 10, 212, 290, 365, 71, 215, 205, 484, 97, 
                      0, 2, 4, 531, 704, 5, 0, 416, 3, 14, 1, 872, 495, 6, 56, 14, 
                      55, 234, 457, 512, 259, 245, 1169, 16, 3, 1, 1, 17, 14, 35, 32, 
                      122, 869, 7, 0, 10, 361, 121, 20, 125, 86, 180, 22, 25, 8, 2597, 
                      3229, 359, 0, 12, 111, 221, 1, 0, 22, 171, 268, 9, 5, 330, 13, 
                      365, 87, 15, 39, 0, 1716, 513, 53, 324, 54, 30, 4889, 112, 21, 
                      475, 2, 1844, 3154, 83, 25, 61, 303, 25, 37, 649, 7, 886, 186, 
                      0, 41, 7, 400, 1533, 962, 65, 265, 265, 642, 149, 1, 7, 13, 490, 
                      25, 11, 2, 767, 7, 5, 6, 160, 377, 8, 58, 47, 469, 129, 2407, 
                      894, 251, 34, 820, 22, 7, 0, 0, 31, 9, 12, 18, 256, 1229, 5, 
                      0, 17, 448, 587, 121, 172, 48, 145, 7, 71, 32, 1956, 2841, 68, 
                      0, 26, 137, 220, 8, 0, 1, 18, 195, 1, 15, 642, 8, 361, 130, 17, 
                      167, 9, 1940, 808, 0, 161, 322, 24, 1451, 20, 3, 503, 0, 351, 
                      708, 23, 5, 22, 636, 23, 28, 98, 0, 245, 261, 2, 26, 6, 772, 
                      936, 2522, 12, 492, 38, 185, 523, 17, 4, 46, 123, 173, 4, 1, 
                      113, 2, 3, 3, 260, 83, 9, 75, 8, 126, 119, 2186, 82, 27, 165, 
                      200, 63, 0, 4, 2, 17, 6, 71, 62, 213, 306, 18, 6, 24, 2163, 403, 
                      3, 425, 18, 104, 2, 60, 7, 669, 1773, 204, 0, 10, 53, 46, 3, 
                      1, 11, 3, 478, 1, 105, 236, 0, 839, 163, 4, 277, 4, 698, 203, 
                      34, 522, 271, 6, 2513, 35, 22, 226, 0, 171, 2947, 103, 3, 50, 
                      504, 34, 327, 414, 23, 974, 118, 0, 12, 15, 868, 87, 3406, 64, 
                      172, 23, 804, 168, 12, 12, 12, 492, 1346, 5, 4, 603, 2, 1, 3, 
                      248, 529, 5, 25, 36, 263, 55, 1462, 82, 95, 132, 362, 9, 0, 7, 
                      7, 37, 8, 15, 54, 192, 887, 8, 5, 58, 392, 61, 80, 83, 233, 375, 
                      14, 106, 33, 961, 2260, 72, 3, 27, 116, 62, 4, 0, 15, 61, 169, 
                      2, 6, 273, 14, 75, 218, 15, 77, 4, 725, 297, 14, 690, 306, 6, 
                      2355, 16, 55, 255, 1, 814, 1885, 141, 5, 105, 392, 2, 251, 341, 
                      2, 757, 453, 1, 155, 21, 559, 308, 1966, 52, 234, 118, 381, 180, 
                      1, 4, 29, 138, 1723, 1, 2, 293, 1, 2, 2, 357, 450, 11, 103, 20, 
                      465, 227, 2061, 105, 117, 336, 358, 78, 2, 1, 0, 40, 7, 37, 39, 
                      194, 1368, 24, 1, 15, 1367, 234, 24, 127, 39, 37, 7, 118, 19, 
                      1312, 2205, 359, 3, 33, 244, 192, 12, 0, 63, 28, 702, 0, 35, 
                      523, 4, 345, 88, 14, 137, 5, 1113), .Dim = c(100L, 40L))

x <- structure(c(-0.844339967193589, 0.45395990207113, 1.71855032128806, 
                 -0.95388403866073, -1.43252847182277, -0.839858167981599, -0.0230177910874308, 
                 1.29456554200315, 0.346213586637009, -0.10311099805464, 0.31890725145979, 
                 1.52773619862574, -0.18442070633549, 0.450361634536862, -1.20213111247597, 
                 -1.39523181157472, -0.841618660658233, -1.78529169315663, 1.28122872312012, 
                 -0.229029292347961, -0.672056444641905, -0.608711167100082, 0.184564281363745, 
                 -1.84834196724056, -1.91796956395169, 0.758487189624731, -0.238967061645268, 
                 -0.751556514281685, 0.727584390773513, 0.846482488264813, -0.247205075300379, 
                 1.45987904802074, -0.960261806547311, 0.420886857542349, -0.858683316536753, 
                 -1.03733288620224, 0.398254927906739, 0.820690436634318, -0.373434684744865, 
                 0.122098852616795), .Dim = c(2L, 20L))
K <- 20
design.list <- vector("list",2)
design.list[[1]] <- rep(1:2, each = K)
design.list[[2]] <- rep(1, ncol(counts))
size <- apply(counts, 2, quantile, .75)
fit <- QL.fit(counts, design.list, 
              log.offset = log(size), 
              Model = "NegBin",
              print.progress=FALSE)

result.fit <- QL.results(fit, Plot=FALSE)
dim(counts)

